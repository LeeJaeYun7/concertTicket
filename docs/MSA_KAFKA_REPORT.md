

# MSA 기반 서비스 분리 시, Kafka 도입 보고서 

## 개요

이 보고서는 크게 4가지 파트로 구성됩니다.
  
**1) 문제 정의 - 분산 시스템에서 동기적 메세지 전달 방식의 문제** <br>
**2) 문제 해결 - Message 브로커 도입** <br> 
**3) Message 브로커 비교** <br> 
**4) 참고 자료 <br> 

<br> 

#### 1) 문제 정의 - 분산 시스템에서 동기적 메세지 전달 방식의 문제
![image](https://github.com/user-attachments/assets/3ee70a52-dbb1-490e-a17c-83ee5a0f214d)


- MSA 아키텍처와 같은 분산 시스템에서는 한 서버에서 발생한 이벤트를 다른 서버로 전달할 필요성이 있습니다. <br>
  예를 들어, 예약 서버와 결제 서버가 분리되어 있다면, <br>
  예약 이벤트가 완료되기 위해서 결제가 완료되어야 하므로 <br>
  예약 이벤트는 결제 서버로 발송되어야 합니다. <br>

- 그런데 이 때, MSA 아키텍처에서 동기적 방식으로 메시지를 발송하면 <br>
  다음과 같은 문제가 발생할 수 있습니다.


#### (1) 서비스 간의 높은 결합도(Strongly Coupled)   
- **동기 방식**에서는 보내는 서버가 **응답을 기다려야** 합니다. <br>
  이 때, 만약 **수신 서버에 장애나 지연이 발생**한다면 송신 서버는 멈추거나 대기하게 됩니다. <br>
  이로 인해 송신 서버에 지연이 발생할 수 있습니다. <br>
  이러한 문제는 송신 서버와 수신 서버가 **강한 결합**(Strongly Coupled)을 맺고 있는 결과로 볼 수 있습니다. <br>
  **강한 결합**은 서로의 상태에 영향을 주어 시스템의 유연성과 효율성을 저하시킬 수 있습니다. <br> 


#### (2) 흐름 제어(Flow Control)   
- **동기 방식**에서는 수신 서버가 일시적으로 과부하가 걸리거나 빠르게 처리할 수 없는 경우, <br>
   송신 서버가 이에 맞추어서 처리 속도를 조정하거나 흐름을 제어할 수 있는 여지가 제한적입니다 <br>
   이로 인해 유연성이 떨어지고, 비효율적인 지연이 발생할 수 있습니다. <br>    


#### (3) 재처리(Reprocessing)   
- 송신 서버에서 수신 서버로 메시지 발송이 실패하는 경우, 이에 대한 재처리(Reprocessing)가 필요합니다. <br> 
  그런데 동기 방식에서 재처리는 송신 서버에서 추가적인 대기 시간을 유발할 수 있습니다. <br>  
  그리고 이러한 대기 시간으로 인해 시스템의 효율성이나 성능이 저하될 수 있습니다. <br> 


<br> 


#### 2) 문제 해결 - 비동기 Message 브로커 도입

- 위와 같이 동기적 방식에서 발생하는 문제를 해결하기 위해 비동기 Message 브로커 도입을 고려하게 되었습니다.

#### (1) Why Message 브로커인가?


  
